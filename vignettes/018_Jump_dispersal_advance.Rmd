---
title: "'Making the most of invasion records, the case of the spotted lanternfly, part"
  IV: progression of the invasion'
author: "Nadege Belouard"
date: "6/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Yearly net spread of the invasion

Lastly, we can monitor the yearly progress of the diffusive spread (Figure 6). Different biological and evolutionary mechanisms, including spatial sorting, can lead to an increase of the spread of invasive species over time. This can be monitored by looking at the yearly increase in the invasion radius. Here, the tendency is variable between disk portions, but in some cases, the spread seems to increase every year, somewhat conform with the prediction.

```{r compute net spread for each quadrant, fig.cap = "Yearly progress of the diffusive spread", echo=FALSE, warning = FALSE, message = FALSE, fig.width = 8, fig.height = 6}

Dist <- as.data.frame(Results$Dist)
Dist_cast <- dcast(Dist, bio_year ~ portion_name, value.var = "DistToIntro")

Net_spread <- data.frame(bio_year = Dist_cast$bio_year,
                         WNW = rep("NA", 7),
                         NNW = rep("NA", 7),
                         NNE = rep("NA", 7),
                         ENE = rep("NA", 7),
                         WSW = rep("NA", 7),
                         SSW = rep("NA", 7),
                         SSE = rep("NA", 7),
                         ESE = rep("NA", 7))


for (i in 2:length(Dist_cast$bio_year)){
  Net_spread$WNW[i] <- Dist_cast$WNW[i] - Dist_cast$WNW[i-1]
  Net_spread$NNW[i] <- Dist_cast$NNW[i] - Dist_cast$NNW[i-1]
  Net_spread$NNE[i] <- Dist_cast$NNE[i] - Dist_cast$NNE[i-1]
  Net_spread$ENE[i] <- Dist_cast$ENE[i] - Dist_cast$ENE[i-1]
  Net_spread$WSW[i] <- Dist_cast$WSW[i] - Dist_cast$WSW[i-1]
  Net_spread$SSW[i] <- Dist_cast$SSW[i] - Dist_cast$SSW[i-1]
  Net_spread$SSE[i] <- Dist_cast$SSE[i] - Dist_cast$SSE[i-1]
  Net_spread$ESE[i] <- Dist_cast$ESE[i] - Dist_cast$ESE[i-1]
  
}

Net_spread_melt <- melt(Net_spread, id = "bio_year")
Net_spread_melt$value <- as.numeric(Net_spread_melt$value)


spread <- ggplot(data = Net_spread_melt, aes(x = bio_year, y = value)) +
  facet_wrap(~variable, ncol = 4) +
  geom_bar(stat="identity", fill = "grey", col = "black") +
  ylab("Yearly advance (km)")+
  xlab("Year") +
  theme_classic()


spread
ggsave("../figures/vignette_quadrants/yearly_spread.jpg", height=6, width=8)

```